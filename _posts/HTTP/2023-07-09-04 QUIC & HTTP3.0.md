---
layout:     post
title:     	QUIC & HTTP3.0
subtitle:  
date:       2023-07-09
author:     
header-img: 
catalog: true
tags:
  - HTTP 相关内容
typora-root-url: ..
---

### 前言

HTTP2.0 是以 SPDY 协议为基础，而 HTTP 3.0 是由 QUIC（同样也是谷歌的） 这个协议为基础的，QUIC 是基于 UDP 的协议。

![image-20230709230220766](/../img/postImage/image-20230709230220766.png)

###  HTTP2.0 的问题

- 对头阻塞（如果出现丢包的情况下，整个 HTTP 都要等待重传，而 HTTP1.1 由于是开启多个 TCP 的，不会影响到其他的 TCP 连接）
- 建立连接的握手延迟大（TCP 握手延迟，TLS 完全握手连接至少需要两个 RTT）

### QUIC 特性

- 0 RTT

    通过使用类似 TCP 快速打开的技术，缓存当前的上下文，在下次恢复会话的时候，只需要将之前的缓存传送到服务端验证通过就可以进行传输了。

    ![image-20230709231128798](/../img/postImage/image-20230709231128798.png)

- 没有对头阻塞的多路复用

    TCP 带来的对头阻塞问题，QUIC 原生实现了多路复用，并且传输单个数据流，可以保证有序交付，不会影响到其他数据流。

    ![image-20230709231523762](/../img/postImage/image-20230709231523762.png)HTTP2.0 在一个 TCP 上同时发送 4 个 stream,  stream1 和 stream2 已经到达，但是 stream3 丢失了，TCP 为了保证数据的可靠性，需要发送端重传第三个包，才能通知应用层读取后面的数据。这样就被阻塞住了。

    ![image-20230709231758826](/../img/postImage/image-20230709231758826.png)对于 UDP，丢包不会影响后续的 stream 包。虽然 stream2 需要重传，但是 stream3 不需要等待这个重传。

    > QUIC 在移动端的表现也比 TCP 好，TCP 基于 IP 和 端口来识别连接的，这种方式在多变的移动端网络环境下很脆弱，QUIC 是通过 ID 的方式去识别一个连接，不管网络环境如何变化，只要 ID 不变，就可以迅速的连接上。

- 前向纠错

    每个数据包除了本身的内容之外，还包括其他包的内容，少量的丢包可以通过其他包的冗余数据直接组装而无需重传。牺牲了每个数据包数据传输的上限，但是减少了因为丢包导致的数据重传。

    **限制是只能丢失一个包**，如果丢失了多个包，还是只能重传。