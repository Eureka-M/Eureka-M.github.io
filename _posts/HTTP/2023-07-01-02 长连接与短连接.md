---
layout:     post
title:      长连接与短连接
subtitle:  
date:       2023-07-01
author:     
header-img: 
catalog: true
tags:
  - HTTP 相关内容
typora-root-url: ..
---

- 能一次性节约很多资源，服务很多次的是长连接。而一锤子买卖就是短连接。

- HTTP 协议是基于请求/响应模式的，因此只要服务端给了响应，本次 HTTP 请求就结束了。**HTTP 长连接和短连接本质上是 TCP 长连接和短连接。**

- HTTP 1.0 中，默认使用短连接。HTTP 1.1 起，默认使用长连接，以保持连接状态，节约资源。

- 长连接可以在请求响应头中看到标志：

    ```
    Connection: keep-alive
    ```

使用长连接的情况下，当一个网页打开完成之后，客户端和服务器之间用于请求 http 数据的 tcp 连接不会关闭。如果客户端再次访问这个服务器上的网页，会继续使用这条已经建立的连接。

keep-alive 不会保持永久的连接，它其实也有一个保持时间，可以在不同的服务器软件比如说，中间件（比如apache 等）里面进行设置。

**实现长链接需要客户端和服务端都支持长连接。**

流程：

![image-20230709224710778](/../img/postImage/image-20230709224710778.png)

和短链接不一样，**长链接的客户端一般不会主动关闭连接**。

但是随着客户端的请求越来越多，那服务器的压力也会越来越大。这个时候服务端也会采取一些策略，比如说

1. 关闭一些长时间没有读写事件发生的连接，这样可以避免一些恶意连接导致服务端受损。
2. 以客户端机器为力度设置每个客户端的最大连接数。